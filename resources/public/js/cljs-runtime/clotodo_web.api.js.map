{"version":3,"sources":["clotodo_web/api.cljs"],"mappings":";AAIA,0BAAA,1BAAKA;AAEL,8BAAA,9BAAMC;AAAN,AAAA,kDAAA,gBACmB,CAAA,sDAAA,AAAAC,gBAAgBC;;AAEnC,yBAAA,zBAAMC,0DAAQC,MAAMC,SAASC,SAASC;AAAtC,AACE,+JAAA,2CAAA,wDAAA,2CAAA,6DAAA,sEAAA,6EAAA,0DAAA,qDAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,n7BAACC,oDAAK,yBAAA,xBAAKT,wSACYK,mEAAgBC,qEAAmBC,8XAI1CC;AALhB,AAMuB,qDAAA,9CAACE,sBAAOC;;;AAEjC,yBAAA,zBAAMC,0DAAQP,MAAME,SAASC;AAA7B,AACE,+JAAA,2CAAA,wDAAA,2CAAA,6DAAA,6EAAA,0DAAA,qDAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,72BAACC,oDAAK,yBAAA,xBAAKT,wSACYK,kEAAgBE,8XAIvBC;AALhB,AAMuB,qDAAA,9CAACE,sBAAOC;;;AAEjC,4BAAA,5BAAME,gEAAWL;AAAjB,AACE,wJAAA,2CAAA,yFAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,nmBAACM,mDAAI,yBAAA,xBAAKd,mMACK,AAACC,4RAGDO;AAJf,AAKsB,qDAAA,9CAACE,sBAAOC;;;AAEhC,8BAAA,9BAAMI,oEAAaC,KAAKC,UAAUT;AAAlC,AACE,yJAAA,2CAAA,yFAAA,wDAAA,2CAAA,0DAAA,kFAAA,0DAAA,qDAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,l8BAACC,oDAAK,yBAAA,xBAAKT,mMACK,AAACC,sLACKe,qEAAgBC,+XAItBT;AANhB,AAOuB,qDAAA,9CAACE,sBAAOC;;;AAEjC,4BAAA,5BAAMO,gEAAWC,YAAYX;AAA7B,AACE,8JAAA,2CAAA,yFAAA,wDAAA,2CAAA,uFAAA,0DAAA,qDAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,l5BAACC,oDAAK,yBAAA,xBAAKT,wMACK,AAACC,oMACYkB,iYAIbX;AANhB,AAOuB,qDAAA,9CAACE,sBAAOC;;;AAEjC,4BAAA,5BAAMS,gEAAWC,QAAQb;AAAzB,AACC,uNAAA,2CAAA,yFAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,lqBAACM,mDAAI,yBAAA,+DAAA,vFAAKd,8EAAkBqB,oLAChB,AAACpB,4RAGDO;AAJZ,AAKmB,qDAAA,9CAACE,sBAAOC;;;AAG5B,8BAAA,9BAAMW,oEAAaD,QAAQE,MAAMC,YAAYhB;AAA7C,AACC,wNAAA,2CAAA,yFAAA,wDAAA,2CAAA,4DAAA,wFAAA,0DAAA,qDAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,zgCAACC,oDAAK,yBAAA,+DAAA,vFAAKT,8EAAkBqB,oLACjB,AAACpB,uLACMsB,0EAAmBC,iYAI1BhB;AANZ,AAOmB,qDAAA,9CAACE,sBAAOC;;;AAG5B,8BAAA,9BAAMc,oEAAaC,QAAQlB;AAA3B,AACC,wNAAA,2CAAA,yFAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,nqBAACmB,mDAAI,yBAAA,+DAAA,vFAAK3B,8EAAkB0B,qLAChB,AAACzB,4RAGDO;AAJZ,AAKmB,qDAAA,9CAACE,sBAAOC;;;AAG5B,8BAAA,9BAAMiB,oEAAaF,QAAQlB;AAA3B,AACC,iNAAA,2CAAA,yFAAA,2EAAA,qDAAA,8DAAA,KAAA,oEAAA,uEAAA,5pBAACqB,sDAAO,yBAAA,xBAAK7B,8EAAkB0B,2KACnB,AAACzB,4RAGDO;AAJZ,AAKmB,qDAAA,9CAACE,sBAAOC","names":["clotodo-web.api/api-url","clotodo-web.api/auth-header","cljs.core/deref","clotodo-web.state/token","clotodo-web.api/signup","email","username","password","callback","ajax.core.POST","cljs.core/reset!","clotodo-web.state/error","clotodo-web.api/signin","clotodo-web.api/get-rooms","ajax.core.GET","clotodo-web.api/create-room","name","is-public","clotodo-web.api/join-room","access-code","clotodo-web.api/get-todos","room-id","clotodo-web.api/create-todo","title","description","clotodo-web.api/toggle-todo","todo-id","ajax.core.PUT","clotodo-web.api/delete-todo","ajax.core.DELETE"],"sourcesContent":["(ns clotodo-web.api\n  (:require [clotodo-web.state :as state]\n            [ajax.core :refer [POST GET PUT DELETE]]))\n\n(def api-url \"http://localhost:3000/api\")\n\n(defn auth-header []\n  {\"Authorization\" (str \"Bearer \" @state/token)}) ; Changed from \"Token \" to \"Bearer \"\n\n(defn signup [email username password callback]\n  (POST (str api-url \"/auth/signup\")\n        {:params {:email email :username username :password password}\n         :format :json\n         :response-format :json\n         :keywords? true\n         :handler callback\n         :error-handler #(reset! state/error \"Signup failed\")}))\n\n(defn signin [email password callback]\n  (POST (str api-url \"/auth/signin\")\n        {:params {:email email :password password}\n         :format :json\n         :response-format :json\n         :keywords? true\n         :handler callback\n         :error-handler #(reset! state/error \"Invalid credentials\")}))\n\n(defn get-rooms [callback]\n  (GET (str api-url \"/rooms\")\n       {:headers (auth-header)\n        :response-format :json\n        :keywords? true\n        :handler callback\n        :error-handler #(reset! state/error \"Failed to load rooms\")}))\n\n(defn create-room [name is-public callback]\n  (POST (str api-url \"/rooms\")\n        {:headers (auth-header)\n         :params {:name name :is_public is-public}\n         :format :json\n         :response-format :json\n         :keywords? true\n         :handler callback\n         :error-handler #(reset! state/error \"Failed to create room\")}))\n\n(defn join-room [access-code callback]\n  (POST (str api-url \"/rooms/join\")\n        {:headers (auth-header)\n         :params {:access_code access-code}\n         :format :json\n         :response-format :json\n         :keywords? true\n         :handler callback\n         :error-handler #(reset! state/error \"Invalid room code\")}))\n\n(defn get-todos [room-id callback]\n (GET (str api-url \"/rooms/\" room-id \"/todos\")\n   {:headers (auth-header)\n    :response-format :json\n    :keywords? true\n    :handler callback\n    :error-handler #(reset! state/error \"Failed to load todos\")}))\n\n\n(defn create-todo [room-id title description callback]\n (POST (str api-url \"/rooms/\" room-id \"/todos\")\n   {:headers (auth-header)\n    :params {:title title :description description}\n    :format :json\n    :response-format :json\n    :keywords? true\n    :handler callback\n    :error-handler #(reset! state/error \"Failed to create todo\")}))\n\n\n(defn toggle-todo [todo-id callback]\n (PUT (str api-url \"/todos/\" todo-id \"/toggle\")\n   {:headers (auth-header)\n    :response-format :json\n    :keywords? true\n    :handler callback\n    :error-handler #(reset! state/error \"Failed to update todo\")}))\n\n\n(defn delete-todo [todo-id callback]\n (DELETE (str api-url \"/todos/\" todo-id)\n   {:headers (auth-header)\n    :response-format :json\n    :keywords? true\n    :handler callback\n    :error-handler #(reset! state/error \"Failed to delete todo\")}))"]}